---
- hosts: inf2pcs inf1pcs inf3pcs

  vars:
    weburl: "https://www.perls-testing.de/eligo/mltests/start.php?iIID=21471"
    
  tasks:
  - name: create dir guest configuration
    file:
      path: /home2/guest-prefs
      mode: 0700
      state: directory
      owner: guest-prefs

  - name: create dir for this klassenpc
    file:
      path: /home2/guest-prefs/Schreibtisch
      mode: 0700
      state: directory
      owner: guest-prefs

  - name: copy file to guest account 
    copy: 
      remote_src: true
      src: /usr/share/applications/firefox.desktop 
      dest: /home2/guest-prefs/Schreibtisch/
      owner: guest-prefs
      mode: 0700

 # - name: no gnome-keyring for chromium
 #   replace: 
 #     path: /home2/guest-prefs/Schreibtisch/chromium-browser.desktop 
 #     regexp: '(Exec=chromium-browser)'
 #     replace:   '\1 --password-store=basic'
      
  - name: start firefox with testing URL
    replace: 
      path: /home2/guest-prefs/Schreibtisch/firefox.desktop 
      regexp: '(Exec=firefox.*)'
      replace:   '\1 {{ weburl }}'     
     
  - name: rename desktop file 1
    replace: 
      path: /etc/guest-session/skel/Schreibtisch/firefox.desktop 
      regexp: 'Name=Firefox Web Browser'
      replace:   'Name=Testung'
      

  - name: rename desktop file 2
    replace: 
      path: /etc/guest-session/skel/Schreibtisch/firefox.desktop 
      regexp: 'Name\[de\]=.*'
      replace:   'Name[de]=Testung'
      
      
