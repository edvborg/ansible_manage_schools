---
- name: redhat | Installing Pre-Reqs
  yum:
    name: "lldpd"
    state: "present"
  become: true
  when: ansible_distribution != "Fedora"


- name: redhat | Configuring Interfaces
  template:
    src: "etc/sysconfig/network-scripts/ifcfg.j2"
    dest: "/etc/sysconfig/network-scripts/ifcfg-{{ item['name'] }}"
  register: "config_interface"
  become: true
  with_items: '{{ network_interfaces }}'
  when: >
        config_network_interfaces and
        item['configure']


- name: redhat | Restarting Network Interfaces
  shell: bash -c "ifdown {{ item['item']['name'] }} && ifup {{ item['item']['name'] }}"
  become: true
  with_items: "{{ config_interface['results'] }}"
  when: >
        config_network_interfaces and
        enable_configured_interfaces_after_defining and
        item['item']['configure'] and
        item['changed']
